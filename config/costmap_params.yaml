# ================================
# Nav2 Costmap Configuration
# F1TENTH + Perception_cpp + Tracking_cpp 구조에 최적화
# ================================
# 주의: map_frame, robot_base_frame은 TF tree에 따라 수정할 수 있음
#       대부분 'map' / 'base_link' 그대로 사용 가능
# ================================

global_costmap:
  global_frame: map
  robot_base_frame: base_link
  update_frequency: 10.0
  publish_frequency: 10.0
  rolling_window: true
  width: 20.0
  height: 20.0
  resolution: 0.05

  plugins: ["static_layer", "obstacle_layer", "inflation_layer"]

  static_layer:
    enabled: true

  obstacle_layer:
    enabled: true
    max_obstacle_height: 2.0
    observation_sources: scan obstacle_points
    
    scan:
      topic: /scan
      data_type: LaserScan
      marking: true
      clearing: true
      expected_update_rate: 0.0
      min_obstacle_height: 0.0

    obstacle_points:
      topic: /obstacle_points
      data_type: PointCloud2
      marking: true
      clearing: false      # 장애물은 clearing 필요 없음
      max_obstacle_height: 1.0

  inflation_layer:
    enabled: true
    inflation_radius: 0.40        # F1TENTH는 좁은 공간 → 너무 크면 회피 불가능
    cost_scaling_factor: 3.0

local_costmap:
  global_frame: map
  robot_base_frame: base_link
  update_frequency: 20.0
  publish_frequency: 20.0
  rolling_window: true
  width: 10.0
  height: 10.0
  resolution: 0.05

  plugins: ["obstacle_layer", "inflation_layer"]

  obstacle_layer:
    enabled: true
    max_obstacle_height: 2.0
    observation_sources: scan obstacle_points

    scan:
      topic: /scan
      data_type: LaserScan
      marking: true
      clearing: true
      expected_update_rate: 0.0
      min_obstacle_height: 0.0

    obstacle_points:
      topic: /obstacle_points
      data_type: PointCloud2
      marking: true
      clearing: false
      max_obstacle_height: 1.0

  inflation_layer:
    enabled: true
    inflation_radius: 0.30         # local costmap은 더 좁은 반경이 적절
    cost_scaling_factor: 3.0
